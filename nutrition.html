  <!DOCTYPE html>
  <html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Personalized Nutrition for Every Body</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"/>
    <style>
      .bg-custom-dark { background-color: #121212; }
      .bg-custom-surface { background-color: #1E1E1E; }
      .bg-custom-primary { background-color: #62E0A1; }
      .bg-custom-secondary { background-color: #36CFFF; }
      .bg-custom-accent { background-color: #F2B33D; }
      .text-custom-primary { color: #62E0A1; }
      .text-custom-secondary { color: #36CFFF; }
      .text-custom-accent { color: #F2B33D; }
      .border-custom-surface { border-color: #1E1E1E; }
      /* Dropdown styles from preference.html */
      .dropdown-container { position: relative; }
      .dropdown-button {
        width: 100%;
        padding: 0.5rem 0;
        background-color: transparent;
        color: white;
        border: none;
        border-bottom: 1px solid #6b7280;
        text-align: left;
        cursor: pointer;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 0.875rem;
      }
      .dropdown-button:hover { border-bottom-color: #62E0A1; }
      .dropdown-button:focus { outline: none; border-bottom-color: #62E0A1; }
      .dropdown-options {
        position: absolute;
        top: 100%;
        left: 0;
        right: 0;
        background-color: #1e1e1e;
        border: 1px solid #4b5563;
        border-radius: 0.5rem;
        margin-top: 0.25rem;
        max-height: 200px;
        overflow-y: auto;
        z-index: 1000;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);
      }
      .dropdown-option {
        padding: 0.75rem;
        cursor: pointer;
        border-radius: 0.25rem;
        margin: 0.25rem;
        transition: background-color 0.2s;
        font-size: 0.875rem;
      }
      .dropdown-option:hover { background-color: #2a2a2a; }
      .dropdown-option.selected { background-color: #62E0A1; color: #000; }
      .dropdown-options::-webkit-scrollbar { width: 8px; }
      .dropdown-options::-webkit-scrollbar-track { background: #1e1e1e; border-radius: 4px; }
      .dropdown-options::-webkit-scrollbar-thumb { background: #4b5563; border-radius: 4px; }
      .dropdown-options::-webkit-scrollbar-thumb:hover { background: #6b7280; }
      .dropdown-options { scrollbar-width: thin; scrollbar-color: #4b5563 #1e1e1e; }
      /* Marquee animation */
      @keyframes marquee {
        0% { transform: translateX(0); }
        100% { transform: translateX(-50%); }
      }
      .animate-marquee {
        animation: marquee 32s linear infinite;
      }
      .marquee-card {
        min-width: 360px;
        max-width: 360px;
        min-height: 340px;
        background: #121212;
        border-radius: 1.5rem;
        box-shadow: 0 4px 24px 0 rgba(0,0,0,0.15);
        border: 1px solid #333;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: 1.5rem 1rem 1.5rem 1rem;
        margin-right: 2.5rem;
        gap: 1.1rem;
        transition: box-shadow 0.2s;
        word-break: break-word;
        overflow: hidden;
      }
      .marquee-card img {
        width: 135px;
        height: 135px;
        object-fit: cover;
        border-radius: 1rem;
        margin-bottom: 0.5rem;
        border: 3px solid #62E0A1;
        background: #222;
        box-shadow: 0 2px 12px 0 rgba(0,0,0,0.10);
        display: block;
      }
      .marquee-card-title {
        font-weight: 700;
        font-size: 1.15rem;
        color: #62E0A1;
        text-align: center;
        word-break: break-word;
        margin-bottom: 0.2rem;
        max-width: 95%;
      }
      .marquee-card-list {
        list-style: disc inside;
        color: #bbb;
        font-size: 1rem;
        padding: 0;
        margin: 0;
        text-align: left;
        width: 100%;
        max-width: 95%;
        display: flex;
        flex-direction: column;
        gap: 0.25rem;
        word-break: break-word;
      }
      .marquee-card-list li {
        margin: 0;
        padding: 0;
        line-height: 1.4;
        word-break: break-word;
        max-width: 100%;
        overflow-wrap: break-word;
        display: flex;
        align-items: flex-start;
        gap: 0.3em;
      }
      .marquee-card-list .label {
        font-weight: bold;
        color: #62E0A1;
        white-space: nowrap;
        flex-shrink: 0;
      }
      .marquee-card-list .value {
        color: #bbb;
        word-break: break-word;
        flex: 1 1 0%;
        min-width: 0;
      }
      @media (max-width: 900px) {
        .marquee-card { min-width: 220px; max-width: 220px; min-height: 220px; padding: 1rem 0.5rem; }
        .marquee-card img { width: 70px; height: 70px; }
        .marquee-card-title { font-size: 1rem; }
        .marquee-card-list { font-size: 0.93rem; }
      }
      @media (max-width: 600px) {
        .marquee-card { min-width: 150px; max-width: 150px; min-height: 180px; padding: 0.75rem 0.25rem; gap: 0.5rem; }
        .marquee-card img { width: 50px; height: 50px; }
        .marquee-card-title { font-size: 0.95rem; }
        .marquee-card-list { font-size: 0.82rem; }
      }
      /* Seamless marquee loop fix */
      .marquee-outer {
        overflow: hidden;
        position: relative;
        width: 100%;
      }
      .marquee-inner {
        display: flex;
        width: max-content;
        animation: marquee-loop 38s linear infinite;
      }
      @keyframes marquee-loop {
        0% { transform: translateX(0); }
        100% { transform: translateX(-50%); }
      }
      .plan-btn {
        min-width: 110px;
        min-height: 38px;
        padding: 0.5em 1em;
        border-radius: 9999px;
        font-weight: 500;
        font-size: 1rem;
        border: 2px solid #333 !important;
        background: linear-gradient(90deg, #232526 0%, #414345 100%) !important;
        color: #e5e7eb !important;
        box-shadow: 0 2px 8px 0 rgba(0,0,0,0.10);
        transition: background 0.18s, color 0.18s, border 0.18s, box-shadow 0.18s;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 0.18em 0.3em 0.18em 0;
      }
      .plan-btn.selected, .plan-btn:focus {
        background: linear-gradient(90deg, #62E0A1 0%, #36CFFF 100%) !important;
        color: #111 !important;
        border-color: #62E0A1 !important;
        outline: none;
        box-shadow: 0 4px 16px 0 rgba(98,224,161,0.15) !important;
      }
      #selected-tags-box {
        justify-content: center;
        flex-wrap: wrap;
        gap: 0.3em;
      }
      #selected-tags-box .tag {
        background: linear-gradient(90deg, #62E0A1 0%, #36CFFF 100%);
        color: #111;
        border-radius: 9999px;
        padding: 0.3em 0.9em;
        font-size: 1em;
        font-weight: 500;
        display: flex;
        align-items: center;
        gap: 0.5em;
        box-shadow: 0 2px 8px 0 rgba(98,224,161,0.10);
        margin: 0.2em 0.4em;
      }
      .main-card-accent-border {
        border: 3px solid #F2B33D !important;
        box-shadow: 0 0 0 3px rgba(242,179,61,0.18), 0 4px 24px 0 rgba(0,0,0,0.10);
      }
    </style>
  </head>
  <body class="bg-custom-dark text-white font-sans">
    <!-- Navigation Bar -->
    <header id="main-navbar" class="flex items-center justify-between px-6 sm:px-10 py-4 bg-[#1E1E1E] shadow-md sticky top-0 z-50 rounded-b-xl">
      <div class="flex items-center space-x-3">
        <div class="text-3xl font-extrabold bg-gradient-to-r from-[#62E0A1] to-[#36CFFF] text-transparent bg-clip-text drop-shadow-md tracking-wider animate-pulse">FitLife</div>
      </div>
      <nav class="space-x-6 text-lg">
        <a href="HomePage.html" class="hover:text-custom-primary transition">Home</a>
        <a href="profile.html" class="hover:text-custom-primary transition">Profile</a>
        <a href="contact.html" class="hover:text-custom-primary transition">Contact</a>
        <a href="ai-companion-page.html" class="hover:text-custom-primary transition">AI Companion</a>
        <a href="login.html" class="bg-gradient-to-r from-[#62E0A1] to-[#F2B33D] text-black px-5 py-2 rounded-full font-semibold hover:scale-105 transition shadow-md">Get Started</a>
      </nav>
    </header>
    <div class="flex min-h-screen p-4">
      <!-- Sidebar -->
      <aside class="flex flex-col bg-custom-surface w-20 md:w-48 p-4 rounded-2xl">
        <div class="flex items-center space-x-3 bg-custom-dark p-2 rounded-lg">
          <div class="relative">
            <img src="https://storage.googleapis.com/a1aa/image/d2cfe623-1544-4224-2da4-46a005423708.jpg" alt="Profile" class="rounded-md w-10 h-10" />
            <button title="Edit Profile Picture" class="absolute bottom-0 right-0 bg-custom-primary text-black rounded-full w-5 h-5 flex items-center justify-center text-xs border border-white">
              <i class="fas fa-edit"></i>
            </button>
          </div>
          <div class="hidden md:block text-xs text-gray-300">
            <p class="font-normal">Nitish</p>
          </div>
        </div>
        <nav class="flex flex-col space-y-2 text-sm mt-6">
          <a href="profile.html" class="flex items-center space-x-2 hover:bg-custom-dark px-3 py-2 rounded-full">
            <i class="fas fa-calendar-alt"></i>
            <span class="hidden md:inline">Schedule</span>
          </a>
          <a href="workout.html" class="flex items-center space-x-2 hover:bg-custom-dark px-3 py-2 rounded-full">
            <i class="fas fa-dumbbell"></i>
            <span class="hidden md:inline">Workouts</span>
          </a>
          <a href="nutrition.html" class="flex items-center space-x-2 bg-custom-secondary text-black px-3 py-2 rounded-full">
            <i class="fas fa-utensils"></i>
            <span class="hidden md:inline">Nutrition</span>
          </a>
        </nav>
        <div class="mt-auto pt-8 space-y-2">
          <a href="preference.html" class="flex items-center space-x-2 hover:bg-custom-dark px-3 py-2 rounded-full">
            <i class="fas fa-cog"></i>
            <span class="hidden md:inline">Preferences</span>
          </a>
          <a href="signout.html" class="flex items-center space-x-2 hover:bg-custom-dark px-3 py-2 rounded-full">
            <i class="fas fa-sign-out-alt"></i>
            <span class="hidden md:inline">Sign out</span>
          </a>
        </div>
      </aside>
      <!-- Main Content -->
      <main class="flex-1 bg-custom-surface p-6 ml-4 rounded-2xl space-y-6">
        <p class="text-xs text-gray-400">Home / Nutrition</p>
        <!-- Welcome Section -->
        <section class="bg-custom-primary text-black p-6 rounded-xl mb-6">
          <div class="flex items-center space-x-4">
            <div class="bg-custom-dark text-custom-primary rounded-full w-10 h-10 flex items-center justify-center">
              <i class="fas fa-leaf"></i>
            </div>
            <div class="text-sm">
              <p class="font-bold">Personalized Nutrition</p>
              <p class="text-xs">Get a plan tailored to your goals, health, and lifestyle.</p>
            </div>
          </div>
        </section>
        <!-- Calorie Intake Section (like profile page) -->
        <section class="bg-custom-dark p-4 rounded-xl mt-8">
          <p class="font-semibold text-sm mb-2">Calorie Intake</p>
          <div class="grid grid-cols-4 text-xs mb-2">
            <div></div>
            <div class="text-center font-semibold">Total</div>
            <div class="text-center font-semibold">Goal</div>
            <div class="text-center font-semibold">Left</div>
          </div>
          <div class="text-xs mb-1 flex justify-between">
            <span>Calories</span><span>2200</span><span>2000</span><span>-200</span>
          </div>
          <div class="h-1 bg-gray-700 rounded-full">
            <div class="h-1 bg-custom-primary rounded-full w-[90%]"></div>
          </div>
          <div class="text-xs mt-2 mb-1 flex justify-between">
            <span>Proteins</span><span>150</span><span>200</span><span>70</span>
          </div>
          <div class="h-1 bg-gray-700 rounded-full">
            <div class="h-1 bg-custom-secondary rounded-full w-[75%]"></div>
          </div>
          <div class="text-xs mt-2 mb-1 flex justify-between">
            <span>Carbohydrates</span><span>250</span><span>300</span><span>15</span>
          </div>
          <div class="h-1 bg-gray-700 rounded-full">
            <div class="h-1 bg-custom-accent rounded-full w-[83%]"></div>
          </div>
        </section>
        <!-- Marquee Food Card Slider -->
        <section class="w-full max-w-5xl mx-auto mb-10">
          <div class="marquee-outer rounded-xl">
            <div id="marquee-slider" class="marquee-inner gap-6 py-4">
              <!-- Cards will be injected by JS -->
            </div>
          </div>
        </section>
        <!-- Food Photo Analysis Section -->
        <section class="bg-custom-dark p-6 rounded-xl mt-8 flex flex-col items-center">
          <h2 class="text-xl font-bold mb-6 text-custom-primary flex items-center justify-center"><i class="fas fa-camera mr-2"></i>Analyze Your Meal</h2>
          <form id="foodPhotoForm" class="w-full max-w-4xl mx-auto" onsubmit="event.preventDefault(); analyzeFoodPhoto();">
            <div class="flex flex-col md:flex-row md:items-start md:justify-center gap-10 bg-gray-800 rounded-xl p-8 border border-gray-700 shadow-lg">
              <!-- Photo Upload & Preview -->
              <div class="flex flex-col items-center justify-start w-full md:w-[320px]">
                <div class="relative flex items-center justify-center w-48 h-48 mb-4">
                  <img id="foodPhotoPreview" src="" alt="Food Preview" class="w-48 h-48 object-cover rounded-lg border border-gray-700 absolute hidden" />
                  <img id="randomFoodPhoto" src="https://images.unsplash.com/photo-1504674900247-0877df9cc836?w=400&h=300&fit=crop" alt="Random Food" class="w-48 h-48 object-cover rounded-lg border border-gray-700 absolute" />
                </div>
                <label for="foodPhotoInput" class="bg-custom-primary text-black px-4 py-2 rounded-full font-medium cursor-pointer hover:bg-green-300 transition-colors flex items-center gap-2 mb-3 w-full justify-center">
                  <i class="fas fa-upload"></i> Choose Food Photo
                </label>
                <input type="file" id="foodPhotoInput" accept="image/*" class="hidden" onchange="previewFoodPhoto(event)" />
                <button type="submit" class="bg-custom-primary text-black px-6 py-3 rounded-full font-semibold hover:scale-105 transition shadow-lg hover:shadow-xl w-full">Analyze Food</button>
              </div>
              <!-- Nutrition Facts -->
              <div id="foodAnalysisResults" class="flex-1 flex flex-col items-center md:items-start justify-center mt-8 md:mt-0 md:ml-6 w-full">
                <h3 class="text-lg font-semibold mb-4 text-custom-secondary text-center md:text-left">Estimated Nutrition Facts</h3>
                <div class="grid grid-cols-2 gap-8 w-full max-w-lg">
                  <div class="bg-custom-dark rounded-lg p-8 flex flex-col items-center justify-center min-h-[120px]">
                    <p class="text-xs text-gray-400 mb-2 text-center">Protein</p>
                    <p id="result-protein" class="text-2xl font-bold text-center">18 g</p>
                  </div>
                  <div class="bg-custom-dark rounded-lg p-8 flex flex-col items-center justify-center min-h-[120px]">
                    <p class="text-xs text-gray-400 mb-2 text-center">Calories</p>
                    <p id="result-calories" class="text-2xl font-bold text-center">320 kcal</p>
                  </div>
                  <div class="bg-custom-dark rounded-lg p-8 flex flex-col items-center justify-center min-h-[120px]">
                    <p class="text-xs text-gray-400 mb-2 text-center">Sugar</p>
                    <p id="result-sugar" class="text-2xl font-bold text-center">5 g</p>
                  </div>
                  <div class="bg-custom-dark rounded-lg p-8 flex flex-col items-center justify-center min-h-[120px]">
                    <p class="text-xs text-gray-400 mb-2 text-center">Carbohydrates</p>
                    <p id="result-carbs" class="text-2xl font-bold text-center">42 g</p>
                  </div>
                </div>
              </div>
            </div>
          </form>
        </section>
        <!-- Generate Plan Section (Modern Card Layout) -->
        <section class="w-full mb-8">
          <div class="bg-custom-dark rounded-2xl shadow-2xl p-0 sm:p-1 relative">
            <button onclick="generateNutritionPlan()" class="absolute top-4 right-4 text-gray-400 hover:text-custom-accent text-2xl p-2 rounded-full focus:outline-none focus:ring-2 focus:ring-custom-accent focus:ring-opacity-50 transition" title="Show Meal Plan">
              <i class="fas fa-ellipsis-h"></i>
            </button>
            <div class="bg-custom-dark rounded-2xl p-6 sm:p-10">
              <h2 class="text-2xl sm:text-3xl font-bold text-white mb-6 text-center bg-gradient-to-r from-custom-primary via-custom-secondary to-custom-accent bg-clip-text text-transparent">
                Generate Your Personalized Nutrition Plan
              </h2>
              <form id="nutritionForm" class="space-y-8">
                <div class="space-y-8">
                  <!-- Category: Goal -->
                  <div>
                    <label class="block text-base font-semibold text-custom-primary mb-3">Goal-Based Nutrition</label>
                    <div class="flex flex-row flex-wrap gap-2 w-full" id="goal-btn-group">
                      <button type="button" class="plan-btn" data-category="goal" data-value="Weight Loss">Weight Loss</button>
                      <button type="button" class="plan-btn" data-category="goal" data-value="Muscle Gain">Muscle Gain</button>
                      <button type="button" class="plan-btn" data-category="goal" data-value="Maintain Energy">Maintain Energy</button>
                      <button type="button" class="plan-btn" data-category="goal" data-value="Improve Sleep">Improve Sleep</button>
                      <button type="button" class="plan-btn" data-category="goal" data-value="Balanced Diet">Balanced Diet</button>
                    </div>
                  </div>
                  <hr class="my-2 border-gray-700" />
                  <!-- Category: Condition -->
                  <div>
                    <label class="block text-base font-semibold text-custom-secondary mb-3">Health Conditions</label>
                    <div class="flex flex-row flex-wrap gap-2 w-full" id="condition-btn-group">
                      <button type="button" class="plan-btn" data-category="condition" data-value="Bone Health">Bone Health</button>
                      <button type="button" class="plan-btn" data-category="condition" data-value="Eye Health">Eye Health</button>
                      <button type="button" class="plan-btn" data-category="condition" data-value="Heart Health">Heart Health</button>
                      <button type="button" class="plan-btn" data-category="condition" data-value="Diabetes Friendly">Diabetes Friendly</button>
                      <button type="button" class="plan-btn" data-category="condition" data-value="Senior Wellness">Senior Wellness</button>
                      <button type="button" class="plan-btn" data-category="condition" data-value="PCOS Support">PCOS Support</button>
                      <button type="button" class="plan-btn" data-category="condition" data-value="Thyroid Support">Thyroid Support</button>
                      <button type="button" class="plan-btn" data-category="condition" data-value="Joint Pain">Joint Pain</button>
                    </div>
                  </div>
                  <hr class="my-2 border-gray-700" />
                  <!-- Category: Lifestyle -->
                  <div>
                    <label class="block text-base font-semibold text-custom-accent mb-3">Lifestyle Preferences</label>
                    <div class="flex flex-row flex-wrap gap-2 w-full" id="lifestyle-btn-group">
                      <button type="button" class="plan-btn" data-category="lifestyle" data-value="Vegetarian">Vegetarian</button>
                      <button type="button" class="plan-btn" data-category="lifestyle" data-value="Vegan">Vegan</button>
                      <button type="button" class="plan-btn" data-category="lifestyle" data-value="High Protein">High Protein</button>
                      <button type="button" class="plan-btn" data-category="lifestyle" data-value="Gluten-Free">Gluten-Free</button>
                      <button type="button" class="plan-btn" data-category="lifestyle" data-value="Intermittent Fasting">Intermittent Fasting</button>
                    </div>
                  </div>
                </div>
                <!-- Combined Tags and Input Box with Action Box -->
                <div class="flex flex-row gap-4 mt-6">
                  <div class="flex-1 flex flex-col gap-2 p-4 bg-custom-dark rounded-lg border border-gray-700 min-h-[56px]">
                    <div id="selected-tags-box" class="flex flex-wrap gap-2 mb-2">
                      <!-- Tags will appear here -->
                    </div>
                    <hr class="border-gray-800 my-1" />
                    <div class="flex items-center gap-2">
                      <input id="customInputBox" type="text" placeholder="Type your preferences or notes..." class="flex-1 bg-transparent text-white placeholder-gray-400 outline-none border-none px-2 py-1" />
                      <button type="button" onclick="backspaceInput()" class="bg-gray-800 text-white rounded-full px-3 py-1 hover:bg-gray-700" title="Backspace"><i class="fas fa-backspace"></i></button>
                    </div>
                    <div class="mt-1 text-xs text-gray-400">Selected tags appear above. You can also write your own preferences, restrictions, or notes here.</div>
                  </div>
                  <div class="flex flex-col gap-2 justify-between p-4 bg-custom-dark rounded-lg border border-gray-700 min-w-[140px] max-w-[180px] items-center self-stretch">
                    <button type="button" onclick="clearInput()" class="bg-custom-accent text-black rounded-full px-3 py-1 hover:bg-yellow-400 font-semibold w-full" title="Clear">Clear</button>
                    <button type="button" onclick="generateNutritionPlan()" class="bg-gradient-to-r from-custom-primary to-custom-accent text-white px-6 py-2 rounded-full font-semibold flex items-center justify-center gap-2 shadow-lg border-2 border-custom-accent hover:scale-105 focus:ring-2 focus:ring-custom-accent focus:ring-opacity-50 transition-all w-full" title="Send">
                      <i class="fas fa-paper-plane text-lg"></i>
                      <span class="hidden md:inline">Send</span>
                    </button>
                  </div>
                </div>
              </form>
            </div>
          </div>
        </section>
        <!-- Modal Results Section -->
        <div id="results-modal-overlay" class="hidden fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60 backdrop-blur-sm">
          <div id="results-section" class="relative w-full max-w-4xl mx-auto bg-gray-900 rounded-2xl shadow-2xl p-4 md:p-6 border border-gray-700 animate-fade-in max-h-[80vh] overflow-y-auto custom-scrollbar">
            <button onclick="closeResultsModal()" class="absolute top-4 right-4 text-gray-400 hover:text-custom-accent text-2xl font-bold focus:outline-none" title="Close">&times;</button>
            <h2 class="text-3xl font-bold text-white mb-8 text-center bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent">
              Your Personalized Nutrition Plan
            </h2>
            <div id="nutrition-results" class="space-y-8">
                <!-- Meal Plan with Day Navigation -->
                <div class="space-y-6">
                  <div class="flex items-center justify-center gap-4 mb-2">
                    <button id="prev-day-btn" onclick="changeMealDay(-1)" class="bg-gray-800 hover:bg-custom-primary hover:text-black text-gray-300 rounded-full w-10 h-10 flex items-center justify-center text-2xl transition disabled:opacity-40" title="Previous Day"><i class="fas fa-chevron-left"></i></button>
                    <div class="text-center flex-1">
                      <h3 id="meal-plan-day-title" class="text-2xl font-bold text-custom-primary mb-1">Day 1 Meal Plan</h3>
                      <p id="meal-plan-day-desc" class="text-gray-400 mb-2">Balanced, high-protein, and energy-sustaining meals</p>
                    </div>
                    <button id="next-day-btn" onclick="changeMealDay(1)" class="bg-gray-800 hover:bg-custom-primary hover:text-black text-gray-300 rounded-full w-10 h-10 flex items-center justify-center text-2xl transition" title="Next Day"><i class="fas fa-chevron-right"></i></button>
                  </div>
                  <div id="meal-plan-content"></div>
                </div>
              </div>
          </div>
        </div>
        <style>
          @keyframes fade-in { from { opacity: 0; transform: scale(0.98); } to { opacity: 1; transform: scale(1); } }
          .animate-fade-in { animation: fade-in 0.3s ease; }
          .custom-scrollbar::-webkit-scrollbar { width: 10px; background: #111; }
          .custom-scrollbar::-webkit-scrollbar-thumb { background: #222; border-radius: 8px; }
          .custom-scrollbar { scrollbar-width: thin; scrollbar-color: #222 #111; }
        </style>
      </main>
      <!-- Right Sidebar (profile style) -->
      <aside class="bg-custom-surface w-64 p-4 ml-4 rounded-2xl flex flex-col">
        <div class="flex justify-end mb-4">
          <button class="bg-custom-accent w-8 h-8 rounded-full flex items-center justify-center text-black">
            <i class="fas fa-bell"></i>
          </button>
        </div>
        <div class="bg-custom-primary text-black p-4 rounded-xl text-center">
          <img src="https://storage.googleapis.com/a1aa/image/d2cfe623-1544-4224-2da4-46a005423708.jpg" alt="profile" class="rounded-xl w-16 h-16 mx-auto mb-2" />
          <p class="font-bold">Nitish</p>
          <p class="text-xs">Male, 20 years old</p>
          <hr class="my-2 border-gray-500" />
          <div class="grid grid-cols-3 text-xs">
            <div><p class="font-semibold">Height</p><p>177 cm</p></div>
            <div><p class="font-semibold">Weight</p><p>60 kg</p></div>
            <div><p class="font-semibold">Diet</p><p>Balanced</p></div>
          </div>
        </div>
        <!-- Dates -->
        <div class="flex justify-between mt-6 mb-4 text-xs">
          <div class="text-center">27<br><span class="text-[9px]">Mon</span></div>
          <div class="text-center">28<br><span class="text-[9px]">Tue</span></div>
          <div class="bg-custom-accent text-black w-8 h-8 rounded-full flex items-center justify-center flex-col">
            29<br><span class="text-[9px]">Wed</span>
          </div>
          <div class="text-center">30<br><span class="text-[9px]">Thu</span></div>
          <div class="text-center">31<br><span class="text-[9px]">Fri</span></div>
        </div>
        <!-- Events -->
        <div class="space-y-2 text-xs">
          <p class="font-semibold">Upcoming</p>
          <div class="flex items-center space-x-2">
            <div class="bg-custom-primary text-black rounded-full w-8 h-8 flex items-center justify-center">
              <i class="fas fa-dumbbell"></i>
            </div>
            <p>Strength training</p>
          </div>
          <div class="flex items-center space-x-2">
            <div class="bg-custom-secondary text-black rounded-full w-8 h-8 flex items-center justify-center">
              <i class="fas fa-utensils"></i>
            </div>
            <p>Meal prep</p>
          </div>
          <div class="flex items-center space-x-2">
            <div class="bg-custom-accent text-black rounded-full w-8 h-8 flex items-center justify-center">
              <i class="fas fa-briefcase-medical"></i>
            </div>
            <p>Health check</p>
          </div>
        </div>
        <button class="mt-auto bg-custom-accent text-black py-2 rounded-full text-xs font-semibold mt-6">Edit Plan</button>
      </aside>
    </div>
    <script>
      // Dropdown logic from preference.html
      function toggleDropdown(id) {
        const dropdown = document.getElementById(id + '-dropdown');
        const allDropdowns = document.querySelectorAll('.dropdown-options');
        allDropdowns.forEach(d => {
          if (d !== dropdown) d.classList.add('hidden');
        });
        dropdown.classList.toggle('hidden');
      }
      function selectDropdownOption(id, value) {
        document.getElementById(id + '-display').textContent = value;
        document.getElementById(id + '-dropdown').classList.add('hidden');
        // Store value for plan generation
        dropdownValues[id] = value;
      }
      // Close dropdowns when clicking outside
      document.addEventListener('click', function(event) {
        const dropdowns = document.querySelectorAll('.dropdown-options');
        dropdowns.forEach(dropdown => {
          if (!dropdown.contains(event.target) && !event.target.classList.contains('dropdown-button')) {
            dropdown.classList.add('hidden');
          }
        });
      });
      // Store dropdown values
      let dropdownValues = { goal: '', condition: '', lifestyle: '' };
      // Generate Nutrition Plan button handler
      function generateNutritionPlan() {
        // Use dropdownValues.goal, dropdownValues.condition, dropdownValues.lifestyle
        // You can call your existing logic here, e.g. from nutri-script.js
        // For now, just show the results section
        document.getElementById('results-modal-overlay').classList.remove('hidden');
        // TODO: Integrate with nutri-script.js for actual plan generation
      }
      function closeResultsModal() {
        document.getElementById('results-modal-overlay').classList.add('hidden');
      }
      // Custom input box controls
      function backspaceInput() {
        const input = document.getElementById('customInputBox');
        if (input.value.length > 0) {
          input.value = input.value.slice(0, -1);
        } else {
          // Remove last tag from any category with tags
          const cats = Object.keys(selectedPlan);
          for (let i = cats.length - 1; i >= 0; i--) {
            const arr = selectedPlan[cats[i]];
            if (arr.length > 0) {
              const removed = arr.pop();
              // Unselect the corresponding button
              const btn = document.querySelector(`.plan-btn[data-category='${cats[i]}'][data-value='${removed}']`);
              if (btn) btn.classList.remove('selected');
              updateSelectedTagsBox();
              break;
            }
          }
        }
        input.focus();
      }
      function clearInput() {
        const input = document.getElementById('customInputBox');
        input.value = '';
        // Clear all tags and unselect all buttons
        Object.entries(selectedPlan).forEach(([cat, arr]) => {
          arr.forEach(val => {
            const btn = document.querySelector(`.plan-btn[data-category='${cat}'][data-value='${val}']`);
            if (btn) btn.classList.remove('selected');
          });
          selectedPlan[cat] = [];
        });
        updateSelectedTagsBox();
        input.focus();
      }
      // Food photo preview
      function previewFoodPhoto(event) {
        const input = event.target;
        const preview = document.getElementById('foodPhotoPreview');
        const randomPhoto = document.getElementById('randomFoodPhoto');
        if (input.files && input.files[0]) {
          const reader = new FileReader();
          reader.onload = function(e) {
            preview.src = e.target.result;
            preview.classList.remove('hidden');
            randomPhoto.classList.add('hidden');
          };
          reader.readAsDataURL(input.files[0]);
        } else {
          preview.src = '';
          preview.classList.add('hidden');
          randomPhoto.classList.remove('hidden');
        }
      }
      // On page load, show random food photo and demo nutrition
      window.addEventListener('DOMContentLoaded', function() {
        document.getElementById('foodPhotoPreview').classList.add('hidden');
        document.getElementById('randomFoodPhoto').classList.remove('hidden');
        document.getElementById('foodAnalysisResults').classList.remove('hidden');
        document.getElementById('result-protein').textContent = '18 g';
        document.getElementById('result-calories').textContent = '320 kcal';
        document.getElementById('result-sugar').textContent = '5 g';
        document.getElementById('result-carbs').textContent = '42 g';
      });
      // Placeholder food analysis (replace with real API/ML integration)
      function analyzeFoodPhoto() {
        const preview = document.getElementById('foodPhotoPreview');
        const randomPhoto = document.getElementById('randomFoodPhoto');
        // If user uploaded, show fake result for uploaded; else for random
        document.getElementById('foodAnalysisResults').classList.remove('hidden');
        if (!preview.classList.contains('hidden')) {
          document.getElementById('result-protein').textContent = '22 g';
          document.getElementById('result-calories').textContent = '410 kcal';
          document.getElementById('result-sugar').textContent = '7 g';
          document.getElementById('result-carbs').textContent = '55 g';
        } else {
          document.getElementById('result-protein').textContent = '18 g';
          document.getElementById('result-calories').textContent = '320 kcal';
          document.getElementById('result-sugar').textContent = '5 g';
          document.getElementById('result-carbs').textContent = '42 g';
        }
      }
      // Marquee food data
      const marqueeFoods = [
        {
          img: 'https://images.unsplash.com/photo-1504674900247-0877df9cc836?auto=format&fit=crop&w=400&q=80',
          name: 'Grilled Salmon',
          goodFor: 'Heart & brain health',
          nutrients: 'Omega-3, Protein, Vitamin D'
        },
        {
          img: 'https://images.unsplash.com/photo-1502741338009-cac2772e18bc?auto=format&fit=crop&w=400&q=80',
          name: 'Berry Yogurt Bowl',
          goodFor: 'Immunity, antioxidants',
          nutrients: 'Vitamin C, Probiotics, Antioxidants'
        },
        {
          img: 'https://images.unsplash.com/photo-1467003909585-2f8a72700288?auto=format&fit=crop&w=400&q=80',
          name: 'Avocado Toast',
          goodFor: 'Skin, energy, healthy fats',
          nutrients: 'Vitamin E, Fiber, Potassium'
        },
        {
          img: 'https://images.unsplash.com/photo-1502741338009-cac2772e18bc?auto=format&fit=crop&w=400&q=80',
          name: 'Quinoa Salad',
          goodFor: 'Muscle growth, plant protein',
          nutrients: 'Protein, Iron, Magnesium'
        },
        {
          img: 'https://images.unsplash.com/photo-1512621776951-a57141f2eefd?auto=format&fit=crop&w=400&q=80',
          name: 'Veggie Buddha Bowl',
          goodFor: 'Digestion, weight loss',
          nutrients: 'Fiber, Vitamin A, Folate'
        },
        {
          img: 'https://images.unsplash.com/photo-1504674900247-0877df9cc836?auto=format&fit=crop&w=400&q=80',
          name: 'Oats & Banana',
          goodFor: 'Heart, gut, sustained energy',
          nutrients: 'Beta-glucan, Potassium, Vitamin B6'
        },
        {
          img: 'https://images.unsplash.com/photo-1519864600265-abb23847ef2c?auto=format&fit=crop&w=400&q=80',
          name: 'Chicken Stir Fry',
          goodFor: 'Muscle repair, lean protein',
          nutrients: 'Protein, Vitamin B12, Selenium'
        }
      ];
      // Duplicate cards for seamless loop
      const marqueeSlider = document.getElementById('marquee-slider');
      function renderMarqueeCards() {
        let cards = '';
        // Render two sets for seamless looping
        for (let i = 0; i < 2; i++) {
          marqueeFoods.forEach(food => {
            cards += `<div class='marquee-card'>
              <img src='${food.img}' alt='${food.name}' />
              <div class='marquee-card-title'>${food.name}</div>
              <ul class='marquee-card-list'>
                <li><span class='label'>Good for:</span><span class='value'>${food.goodFor}</span></li>
                <li><span class='label'>Contains:</span><span class='value'>${food.nutrients}</span></li>
              </ul>
            </div>`;
          });
        }
        marqueeSlider.innerHTML = cards;
      }
      renderMarqueeCards();
      // Plan button group logic (multi-select)
      const selectedPlan = { goal: [], condition: [], lifestyle: [] };
      function updateSelectedTagsBox() {
        const box = document.getElementById('selected-tags-box');
        box.innerHTML = '';
        Object.entries(selectedPlan).forEach(([cat, arr]) => {
          arr.forEach(val => {
            const tag = document.createElement('span');
            tag.className = 'tag bg-gradient-to-r from-custom-primary to-custom-secondary text-black px-3 py-1 rounded-full font-semibold text-sm';
            tag.textContent = val;
            box.appendChild(tag);
          });
        });
      }
      function handlePlanBtnClick(e) {
        const btn = e.target.closest('.plan-btn');
        if (!btn) return;
        const cat = btn.getAttribute('data-category');
        const val = btn.getAttribute('data-value');
        const idx = selectedPlan[cat].indexOf(val);
        if (idx === -1) {
          // Select
          btn.classList.add('selected');
          selectedPlan[cat].push(val);
        } else {
          // Deselect
          btn.classList.remove('selected');
          selectedPlan[cat].splice(idx, 1);
        }
        updateSelectedTagsBox();
      }
      document.querySelectorAll('.plan-btn').forEach(btn => {
        btn.addEventListener('click', handlePlanBtnClick);
      });
      // On page load, clear tags
      updateSelectedTagsBox();

      // Meal plan data for multiple days
      const mealPlans = [
        {
          title: 'Day 1 Meal Plan',
          desc: 'Balanced, high-protein, and energy-sustaining meals',
          meals: [
            { name: 'Breakfast', items: [
              'Oats & Banana Bowl (320 kcal, 18g protein)',
              'Greek Yogurt with Berries (150 kcal, 10g protein)',
              'Green Tea',
            ] },
            { name: 'Lunch', items: [
              'Grilled Salmon with Quinoa Salad (480 kcal, 32g protein)',
              'Steamed Broccoli & Carrots',
              'Lemon Water',
            ] },
            { name: 'Snack', items: [
              'Berry Yogurt Bowl (180 kcal, 8g protein)',
              'Handful of Almonds',
            ] },
            { name: 'Dinner', items: [
              'Chicken Stir Fry with Veggies (420 kcal, 35g protein)',
              'Brown Rice (1 cup)',
              'Herbal Tea',
            ] },
          ]
        },
        {
          title: 'Day 2 Meal Plan',
          desc: 'Plant-based, fiber-rich, and heart-healthy meals',
          meals: [
            { name: 'Breakfast', items: [
              'Avocado Toast (250 kcal, 7g protein)',
              'Orange Slices',
              'Black Coffee',
            ] },
            { name: 'Lunch', items: [
              'Quinoa Salad with Chickpeas (400 kcal, 15g protein)',
              'Roasted Sweet Potato',
              'Mint Lemonade',
            ] },
            { name: 'Snack', items: [
              'Veggie Buddha Bowl (220 kcal, 9g protein)',
              'Mixed Nuts',
            ] },
            { name: 'Dinner', items: [
              'Lentil Soup (300 kcal, 18g protein)',
              'Whole Wheat Bread (2 slices)',
              'Chamomile Tea',
            ] },
          ]
        },
        {
          title: 'Day 3 Meal Plan',
          desc: 'Low-carb, high-fiber, and vitamin-rich meals',
          meals: [
            { name: 'Breakfast', items: [
              'Spinach & Feta Omelette (280 kcal, 20g protein)',
              'Tomato Slices',
              'Herbal Tea',
            ] },
            { name: 'Lunch', items: [
              'Turkey Wrap with Veggies (350 kcal, 28g protein)',
              'Apple Slices',
              'Iced Green Tea',
            ] },
            { name: 'Snack', items: [
              'Carrot Sticks with Hummus',
              'Low-fat Cheese Stick',
            ] },
            { name: 'Dinner', items: [
              'Baked Cod with Asparagus (390 kcal, 34g protein)',
              'Quinoa (1/2 cup)',
              'Mint Tea',
            ] },
          ]
        },
        {
          title: 'Day 4 Meal Plan',
          desc: 'Mediterranean-inspired, antioxidant-rich meals',
          meals: [
            { name: 'Breakfast', items: [
              'Greek Yogurt Parfait (200 kcal, 12g protein)',
              'Mixed Berries',
              'Espresso',
            ] },
            { name: 'Lunch', items: [
              'Grilled Chicken Shawarma Salad (420 kcal, 30g protein)',
              'Pita Bread (1/2)',
              'Lemon Water',
            ] },
            { name: 'Snack', items: [
              'Sliced Cucumber with Tzatziki',
              'Walnuts',
            ] },
            { name: 'Dinner', items: [
              'Stuffed Bell Peppers (350 kcal, 22g protein)',
              'Brown Rice (1/2 cup)',
              'Herbal Tea',
            ] },
          ]
        },
        {
          title: 'Day 5 Meal Plan',
          desc: 'Energy-boosting, iron-rich, and balanced meals',
          meals: [
            { name: 'Breakfast', items: [
              'Banana Pancakes (300 kcal, 10g protein)',
              'Peanut Butter (1 tbsp)',
              'Black Coffee',
            ] },
            { name: 'Lunch', items: [
              'Beef & Veggie Stir Fry (500 kcal, 35g protein)',
              'Steamed Rice (1 cup)',
              'Iced Tea',
            ] },
            { name: 'Snack', items: [
              'Apple Slices with Almond Butter',
              'Pumpkin Seeds',
            ] },
            { name: 'Dinner', items: [
              'Grilled Shrimp Tacos (380 kcal, 28g protein)',
              'Cabbage Slaw',
              'Lime Water',
            ] },
          ]
        },
        {
          title: 'Day 6 Meal Plan',
          desc: 'Vegetarian, vitamin-packed, and gut-friendly meals',
          meals: [
            { name: 'Breakfast', items: [
              'Chia Pudding with Mango (220 kcal, 6g protein)',
              'Almond Milk',
              'Green Tea',
            ] },
            { name: 'Lunch', items: [
              'Veggie Burger (350 kcal, 18g protein)',
              'Sweet Potato Fries',
              'Kombucha',
            ] },
            { name: 'Snack', items: [
              'Fruit Salad',
              'Low-fat Yogurt',
            ] },
            { name: 'Dinner', items: [
              'Eggplant Parmesan (400 kcal, 20g protein)',
              'Whole Wheat Pasta (1 cup)',
              'Herbal Tea',
            ] },
          ]
        },
        {
          title: 'Day 7 Meal Plan',
          desc: 'Protein-rich, omega-3, and immune-boosting meals',
          meals: [
            { name: 'Breakfast', items: [
              'Smoked Salmon Bagel (350 kcal, 22g protein)',
              'Sliced Tomato',
              'Black Coffee',
            ] },
            { name: 'Lunch', items: [
              'Chicken Caesar Salad (420 kcal, 34g protein)',
              'Whole Wheat Roll',
              'Sparkling Water',
            ] },
            { name: 'Snack', items: [
              'Protein Bar (200 kcal, 15g protein)',
              'Orange Slices',
            ] },
            { name: 'Dinner', items: [
              'Baked Salmon with Veggies (430 kcal, 36g protein)',
              'Quinoa (1 cup)',
              'Peppermint Tea',
            ] },
          ]
        }
      ];
      let currentMealDay = 0;
      function renderMealPlanDay(idx) {
        const plan = mealPlans[idx];
        document.getElementById('meal-plan-day-title').textContent = plan.title;
        document.getElementById('meal-plan-day-desc').textContent = plan.desc;
        document.getElementById('meal-plan-content').innerHTML = plan.meals.map(meal => `
          <div class='bg-custom-dark rounded-xl p-5 shadow flex flex-col gap-2 mb-4'>
            <h4 class='font-semibold text-lg text-custom-accent mb-1'>${meal.name}</h4>
            <ul class='text-gray-200 text-sm list-disc ml-5'>
              ${meal.items.map(item => `<li>${item}</li>`).join('')}
            </ul>
          </div>
        `).join('');
      }
      function changeMealDay(delta) {
        currentMealDay = (currentMealDay + delta + mealPlans.length) % mealPlans.length;
        renderMealPlanDay(currentMealDay);
      }
      // Show Day 1 by default when modal opens
      const origGenerateNutritionPlan = generateNutritionPlan;
      generateNutritionPlan = function() {
        origGenerateNutritionPlan();
        currentMealDay = 0;
        renderMealPlanDay(currentMealDay);
      };
    </script>
  </body>
  </html> 
